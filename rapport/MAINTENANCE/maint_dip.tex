\chapter{Transformation DIP en PSI}

\section{Hypothèses de travail}


Les fichiers importés sont des fichiers XML au format XIN. Le format
XIN permet de décrire des graphes. Seules les interactions binaires
peuvent donc être représentées. Les protéines sont déclarées comme les
sommets du graphe sous la forme de balises {\it node}. Les arêtes du
graphe représentent les interactions sous la forme de balises {\it
edge}. Les balises {\it node} deviendront des balises {\it
proteinInteractor} dans le format PSI et les balises {\it edge} des
balises {\it interaction}.

Cependant le schéma \texttt{xin.xsd} étant assez laxiste, on considère
que les fichiers DIP ont en-tête de fichier:
\begin{verbatim}
 <attributes>
  <edgeAtt name="class" type="text">
  </edgeAtt>
  <edgeAtt name="name" type="text">
  </edgeAtt>
  <nodeAtt name="descr" type="text">
  </nodeAtt>
  <nodeAtt name="shn" type="text">
  </nodeAtt>
  <nodeAtt name="organism" type="text">
  </nodeAtt>
  <nodeAtt name="taxon" type="text">
  </nodeAtt>
 </attributes>
\end{verbatim}

On ne traite donc que les balises \texttt{att} dont l'attribut {\it name}
vaut {\it descr}, {\it shn}, {\it organism} et {\it taxon} dans les
balises {\it node}. Les {\it att} {\it organism} et {\it taxon} seront
recopiés dans l'élément {\it organism} de l'{\it interactor} dans le
fichier PSI, les {\it att} {\it shn} et {\it descr} seront recopiés
dans la balise {\it names} de chaque {\it interactor}.

Étant donné qu'on n'a trouvé aucune balise dans les balises {\it
edge}, aucun balise n'est traitée.


\section{Évolutions}
En cas de données incomplètes du fichier source, le fichier résultat
peut ne pas être conforme au schéma \texttt{MIF.xsd}. Ceci est
notament le cas lorsque qu'il n'y a pas de \textit{feature} dans les
\textit{edge} du fichier source.\\ Les fichiers sources au format XML
téléchargés sur le site de DIP, ne sont pas tous conformes au schéma
\texttt{XIN.xsd}, les outils développés sont donc construit autour des
fichiers téléchargés et ne seront donc pas forcément compatible avec
des versions ultérieures de ces fichiers.\\ En cas d'utilisation de
nouveaux processeurs XSLT vérifiant les recommandations XSLT 2.0,
permettant de générer deux fichiers en sortie, il est souhaitable de
fusionner les feuilles de style \texttt{dip2psi} et
\texttt{dip2psi\_report}. Cela permet de ne parcourir qu'une fois le
fichier source et de matcher tous les éléments d'une façon plus
évidente.\\ En cas d'ajout de nouvel élément dans le fichier source,
il faut trouver la correspondance dans le format MIF canonique, créer
une règle matchant ce noeud et l'appeler à l'endroit ou l'on souhaite
créer la balise correspondante dans le fichier résultat.

\section{Algorithmes}

La transformation est implémentée en XSLT et est composée de deux
feuilles de style, \texttt{dip2psi} et \texttt{dip2psi\_report} qui
respectivement transforment le fichier DIP en fichier PSI et affichent
dans une page HTML les données du fichier DIP non traitées par la
feuille de style précédente. Ces feuilles de styles sont composées de
différentes règles aussi appelées templates.

\subsection{Feuille de style de transformation}

On présente ici les différentes templates de la transformation
\texttt{dip2psi}.\\ La première règle matche la racine. Elle traite la
balise \textit{project} et crée les balises \textit{entrySet} et
\textit{entry}. Elle crée les attributs de \textit{entrySet} :
\textit{level} initialisé à 1 et \textit{version} initialisé à 12
puisque le fichier résultat vérifie la version 1.12 du schéma
\texttt{MIF.xsd}. Elle appelle les autres templates sur le reste du
fichier DIP.

\subsubsection{Template project}

La seconde règle matche la balise \textit{project}.Cette règle gère
les attributs de la balise \textit{project} et génère la
\textit{source} dans le fichier PSI. Elle appelle d'autres règles sur
les attributs \textit{ver}, \textit{author}, \textit{source} et
\textit{date} afin de les recopier dans la \textit{source} du fichier
destination. Cela permet de ne créer des balises \textit{attribute}
que lorsque c'est nécessaire. \\ Ensuite cette règle crée les balises
\textit{interactorList} et \textit{interactionList} puis appelle les
règles sur les \textit{node} et les \textit{edge}.

\subsubsection{Template node}

Cette règle ne matche que les \textit{node} dont l'attribut
\textit{class} vaut \textit{protein}. Elle génère l'identifiant de la
protéine pour le fichier PSI, crée la balise \textit{names} et y
recopie les \textit{shn} et \textit{descr} si ils existent. Elle
s'occupe des \textit{feature} grâce à une autre template et les recopie dans les \textit{xref} de
la protéine dans le fichier PSI. Ensuite elle crée un élément organism
pour la protéine dans le fichier PSI si les attributs \textit{taxon}
et \textit{organism} sont présents dans le fichier DIP.

\subsubsection{Template feature}

Cette règle matche les balises \textit{feature} dont l'attribut
\textit{class} vaut \textit{cref}. Ces balises correspondent à des
\textit{secondaryRef} dans le fichier PSI.

\subsubsection{Template edge}

Cette règle ne matche que les \textit{edge} dont l'attribut
\textit{class} vaut\textit{link}. Ces balises correspondent à des
interactions. Elle crée un élément \textit{names} lorsque c'est
possible. Ensuite elle crée la balise \textit{participantList} et crée
les deux \textit{interactorRef} des \textit{proteinParticipant}
correspondant aux références des attributs \textit{from} et
\textit{to} de la balise \textit{edge}. Étant donné que l'on n'a
aucune information sur les expériences, on préfère ne pas créer
d'\textit{experimentLists}, plutôt que d'inventer une
\textit{interactionDetection} vide, ce qui malheureusement ne vérifie
pas le schéma défini dans le fichier \texttt{MIF.xsd}.

\subsection{Feuille de style de validation }

Cette feuille de style \textit{dip2psi\_report} matche toutes les
balises qui n'ont pas été traitées par la transformation
\textit{dip2psi} et les écrit de façon structurée dans un rapport au
format HTML. Ainsi toute information est traitée soit par la
transformation \textit{dip2psi} soit par la validation
\textit{dip2psi\_report}. La feuille de style de validation utilise un
parcours semblable à celui de la transformation décrit précédemment.


\section{Format de fichier}

Les fichiers d'entrée sont des fichiers de la base de données DIP, ou
autre conformes au fichier \texttt{xin.xsd} (ou presque) disponible
sur le site de DIP et qui vérifie les hypothèses de travail.

Les fichiers de sortie sont des fichiers PSI sous la forme normalisés
vérifiant le schéma \texttt{MIF.xsd} aux \textit{experimentsList}
près.
